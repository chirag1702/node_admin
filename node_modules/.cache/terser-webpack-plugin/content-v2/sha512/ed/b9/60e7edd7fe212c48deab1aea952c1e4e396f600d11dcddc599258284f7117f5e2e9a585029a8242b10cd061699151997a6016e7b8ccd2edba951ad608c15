{"code":"!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var o in e)t.d(r,o,function(t){return e[t]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=0)}([function(e,t,n){n(1)},function(e,t,n){var r,o,i=n(2),u=n(3);t.initialize=function(e){try{o=e.model(\"IdentityCounter\")}catch(t){if(\"MissingSchemaError\"!==t.name)throw t;(r=new i.Schema({model:{type:String,require:!0},field:{type:String,require:!0},count:{type:Number,default:0}})).index({field:1,model:1},{unique:!0,required:!0,index:-1}),o=e.model(\"IdentityCounter\",r)}},t.plugin=function(e,t){if(!r||!o)throw new Error(\"mongoose-auto-increment has not been initialized\");var n={model:null,field:\"_id\",startAt:0,incrementBy:1,unique:!0},i={},l=!1;switch(typeof t){case\"string\":n.model=t;break;case\"object\":u(n,t)}if(null==n.model)throw new Error(\"model must be set\");i[n.field]={type:Number,require:!0},\"_id\"!==n.field&&(i[n.field].unique=n.unique),e.add(i),o.findOne({model:n.model,field:n.field},(function(e,t){t?l=!0:(t=new o({model:n.model,field:n.field,count:n.startAt-n.incrementBy})).save((function(){l=!0}))}));var f=function(e){o.findOne({model:n.model,field:n.field},(function(t,r){return t?e(t):void e(null,null===r?n.startAt:r.count+n.incrementBy)}))};e.method(\"nextCount\",f),e.static(\"nextCount\",f);var c=function(e){o.findOneAndUpdate({model:n.model,field:n.field},{count:n.startAt-n.incrementBy},{new:!0},(function(t){return t?e(t):void e(null,n.startAt)}))};e.method(\"resetCount\",c),e.static(\"resetCount\",c),e.pre(\"save\",(function(e){var t=this;t.isNew?function r(){l?\"number\"==typeof t[n.field]?o.findOneAndUpdate({model:n.model,field:n.field,count:{$lt:t[n.field]}},{count:t[n.field]},(function(t){return t?e(t):void e()})):o.findOneAndUpdate({model:n.model,field:n.field},{$inc:{count:n.incrementBy}},{new:!0},(function(r,o){return r?e(r):(t[n.field]=o.count,void e())})):setTimeout(r,5)}():e()}))}},function(e){e.exports=mongoose},function(e){\"use strict\";var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,i=function(e){return\"function\"==typeof Array.isArray?Array.isArray(e):\"[object Array]\"===n.call(e)},u=function(e){if(!e||\"[object Object]\"!==n.call(e))return!1;var r=t.call(e,\"constructor\"),o=e.constructor&&e.constructor.prototype&&t.call(e.constructor.prototype,\"isPrototypeOf\");if(e.constructor&&!r&&!o)return!1;for(var i in e);return void 0===i||t.call(e,i)},l=function(e,t){r&&\"__proto__\"===t.name?r(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},f=function(e,n){if(\"__proto__\"===n){if(!t.call(e,n))return;if(o)return o(e,n).value}return e[n]};e.exports=function e(){var t,n,r,o,c,d,a=arguments[0],m=1,s=arguments.length,p=!1;for(\"boolean\"==typeof a&&(p=a,a=arguments[1]||{},m=2),(null==a||\"object\"!=typeof a&&\"function\"!=typeof a)&&(a={});m<s;++m)if(null!=(t=arguments[m]))for(n in t)r=f(a,n),a!==(o=f(t,n))&&(p&&o&&(u(o)||(c=i(o)))?(c?(c=!1,d=r&&i(r)?r:[]):d=r&&u(r)?r:{},l(a,{name:n,newValue:e(p,d,o)})):void 0!==o&&l(a,{name:n,newValue:o}));return a}}]);","extractedComments":[]}